#! env bash

# Select either rofi or dmenu or print error.
if [[ $(which rofi) == "rofi not found" ]] ; then
	if [[ $(which dmenu) == "dmenu not found" ]]; then
		echo "No prompt tool installed, install either rofi or dmenu.";
		exit 1;
	else
		CMD="dmenu -p";
	fi
else
	CMD="rofi -dmenu -sep \n -p";
fi

PREV_SEARCHES=$(cat $HOME/.local/share/env/search | uniq)

URL='https://google.com/search?q='
QUERY=$(echo $PREV_SEARCHES | $CMD "Search:")
if [ -n "$QUERY" ]; then
	echo -e "${QUERY}\n${PREV_SEARCHES}" > $HOME/.local/share/env/search
	xdg-open "${URL}${QUERY}" 2> /dev/null
fi
